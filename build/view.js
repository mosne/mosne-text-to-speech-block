import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(s={getContext:()=>e.getContext,store:()=>e.store},i={},t.d(i,s),i),{state:o,actions:c}=(0,n.store)("mosne-text-to-speech-block",{state:{isPlaying:!1,currentVoice:null,preferredVoice:window.localStorage.getItem("mosne-tts-lang-"+document.documentElement.lang)||null,utterance:null,voices:[],currentSpeed:window.localStorage.getItem("mosne-tts-speed-"+document.documentElement.lang)||1,currentPitch:window.localStorage.getItem("mosne-tts-pitch-"+document.documentElement.lang)||1},actions:{loadVoices(){const e=window.speechSynthesis.getVoices();if(!e)return void console.warn("No voices available");o.voices=e,o.currentVoice=e[0];const t=document.documentElement.lang,n=e.filter((e=>e.lang.startsWith(t)));if(n.length>0&&(o.voices=n,o.currentVoice=n[0],o.preferredVoice)){const e=n.find((e=>e.voiceURI===o.preferredVoice));e&&(o.currentVoice=e)}c.createUtterance()},createUtterance(){const e=c.getContent(),t=new window.SpeechSynthesisUtterance(e);if(t.lang=document.documentElement.lang,t.rate=o.currentSpeed,t.pitch=o.currentPitch,o.currentVoice){const e=o.voices.find((e=>e.voiceURI===o.currentVoice.voiceURI));t.voice=e}else console.warn("Current Voice not found");o.utterance=t},upadateUtterance(){const e=(0,n.getContext)();o.utterance?(window.speechSynthesis.cancel(),e.utterance=null,e.isPlaying=!1,c.createUtterance()):console.warn("Utterance not found")},Play(){(0,n.getContext)().isPlaying=!0,window.speechSynthesis.paused?window.speechSynthesis.resume():o.utterance?(window.speechSynthesis.cancel(),window.speechSynthesis.speak(o.utterance)):console.warn("Utterance not found")},Pause(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.pause()},Restart(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.cancel()},changeVoice(e){(0,n.getContext)().isPlaying=!1;const t=o.voices.find((t=>t.voiceURI===e.target.value));window.speechSynthesis.cancel(),t?(o.currentVoice=t,window.localStorage.setItem("mosne-tts-lang-"+document.documentElement.lang,t.voiceURI),c.upadateUtterance()):console.warn("Voice not found")},changeSpeed(e){o.currentSpeed=e.target.value,window.localStorage.setItem("mosne-tts-speed-"+document.documentElement.lang,e.target.value),c.upadateUtterance()},changePitch(e){o.currentPitch=e.target.value,window.localStorage.setItem("mosne-tts-pitch-"+document.documentElement.lang,e.target.value),c.upadateUtterance()},toggleSettings(){const e=(0,n.getContext)();e.showSettings=!e.showSettings},getContent(){let e="",t=document.querySelector("main").cloneNode(!0);return t&&(t.querySelectorAll(".skip-speech").forEach((e=>{e.remove()})),e=t.textContent,t=null),e}},callbacks:{init(){window.speechSynthesis&&(window.speechSynthesis.cancel(),c.loadVoices(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=c.loadVoices))},isSelected:()=>(0,n.getContext)().voice.voiceURI===o.currentVoice.voiceURI}});var s,i;