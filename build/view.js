import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var c in n)t.o(n,c)&&!t.o(e,c)&&Object.defineProperty(e,c,{enumerable:!0,get:n[c]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(s={getContext:()=>e.getContext,store:()=>e.store},i={},t.d(i,s),i),{state:c,actions:o}=(0,n.store)("mosne-text-to-speech-block",{state:{isPlaying:!1,currentVoice:null,preferredVoice:window.localStorage.getItem("mosne-tts-lang-"+document.documentElement.lang)||null,utterance:null,voices:[],currentSpeed:window.localStorage.getItem("mosne-tts-speed-"+document.documentElement.lang)||1,currentPitch:window.localStorage.getItem("mosne-tts-pitch-"+document.documentElement.lang)||1},actions:{loadVoices(){const e=window.speechSynthesis.getVoices();if(!e)return;c.voices=e,c.currentVoice=e[0];const t=document.documentElement.lang,n=e.filter((e=>e.lang.startsWith(t)));if(n.length>0&&(c.voices=n,c.currentVoice=n[0],c.preferredVoice)){const e=n.find((e=>e.voiceURI===c.preferredVoice));e&&(c.currentVoice=e)}o.createUtterance()},createUtterance(){const e=o.getContent(),t=new window.SpeechSynthesisUtterance(e);if(t.lang=document.documentElement.lang,t.rate=c.currentSpeed,t.pitch=c.currentPitch,c.currentVoice){const e=c.voices.find((e=>e.voiceURI===c.currentVoice.voiceURI));t.voice=e}c.utterance=t},upadateUtterance(){const e=(0,n.getContext)();c.utterance&&(window.speechSynthesis.cancel(),e.utterance=null,e.isPlaying=!1,o.createUtterance())},Play(){(0,n.getContext)().isPlaying=!0,window.speechSynthesis.paused?window.speechSynthesis.resume():c.utterance&&(window.speechSynthesis.cancel(),window.speechSynthesis.speak(c.utterance))},Pause(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.pause()},Restart(){(0,n.getContext)().isPlaying=!1,window.speechSynthesis.cancel()},changeVoice(e){(0,n.getContext)().isPlaying=!1;const t=c.voices.find((t=>t.voiceURI===e.target.value));window.speechSynthesis.cancel(),t&&(c.currentVoice=t,window.localStorage.setItem("mosne-tts-lang-"+document.documentElement.lang,t.voiceURI),o.upadateUtterance())},changeSpeed(e){c.currentSpeed=e.target.value,window.localStorage.setItem("mosne-tts-speed-"+document.documentElement.lang,e.target.value),o.upadateUtterance()},changePitch(e){c.currentPitch=e.target.value,window.localStorage.setItem("mosne-tts-pitch-"+document.documentElement.lang,e.target.value),o.upadateUtterance()},toggleSettings(){const e=(0,n.getContext)();e.showSettings=!e.showSettings},getContent(){let e="",t=document.querySelector("main").cloneNode(!0);return t&&(t.querySelectorAll(".skip-speech").forEach((e=>{e.remove()})),e=t.textContent,t=null),e}},callbacks:{init(){window.speechSynthesis&&(window.speechSynthesis.cancel(),o.loadVoices(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=o.loadVoices))},isSelected:()=>(0,n.getContext)().voice.voiceURI===c.currentVoice.voiceURI}});var s,i;