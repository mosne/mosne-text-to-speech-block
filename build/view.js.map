{"version":3,"file":"view.js","mappings":";;;;;;;;;AAAA;;;;;;SCAA;SACA;;SAEA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;;SAEA;SACA;;SAEA;SACA;SACA;;;;;UCtBA;UACA;UACA;UACA,uDAAuD,iBAAiB;UACxE;UACA,gDAAgD,aAAa;UAC7D;;;;;;;;;;;;ACNA;AACA;AACA;AAC6D;;AAE7D;AACA,MAAME,YAAY,GAAG;EACpBC,IAAI,EAAIC,IAAI,IAAM,kBAAmBA,IAAI,EAAG;EAC5CC,KAAK,EAAID,IAAI,IAAM,mBAAoBA,IAAI,EAAG;EAC9CE,KAAK,EAAIF,IAAI,IAAM,mBAAoBA,IAAI;AAC5C,CAAC;AAED,MAAMG,QAAQ,GAAG;EAChBC,YAAY,EAAE,SAAS;EACvBC,eAAe,EAAE,SAAS;EAC1BC,aAAa,EAAE,aAAa;EAC5BC,eAAe,EAAE;AAClB,CAAC;;AAED;AACA,MAAMC,mBAAmB,GAAGA,CAAEC,GAAG,EAAEC,YAAY,KAC9CC,MAAM,CAACC,YAAY,CAACC,OAAO,CAAEJ,GAAI,CAAC,IAAIC,YAAY;AAEnD,MAAMI,gBAAgB,GAAGA,CAAA,KAAMC,QAAQ,CAACC,eAAe,CAAChB,IAAI;AAE5D,MAAMiB,eAAe,GAAGA,CAAA,KACvBF,QAAQ,CAACG,aAAa,CACrB,oDACD,CAAC;AAEF,MAAMC,cAAc,GAAGA,CAAA,KAAMJ,QAAQ,CAACG,aAAa,CAAE,MAAO,CAAC;AAE7D,MAAME,UAAU,GAAKC,IAAI,IAAM;EAC9B;EACA,IAAKA,IAAI,CAACC,QAAQ,KAAKC,IAAI,CAACC,SAAS,EAAG;IACvC,OAAO,IAAI;EACZ;;EAEA;EACA,IAAKH,IAAI,CAACC,QAAQ,KAAKC,IAAI,CAACE,YAAY,EAAG;IAC1C,KAAM,MAAMC,KAAK,IAAIL,IAAI,CAACM,UAAU,EAAG;MACtC,IAAKD,KAAK,CAACJ,QAAQ,KAAKC,IAAI,CAACC,SAAS,EAAG;QACxC,OAAO,KAAK;MACb;IACD;IACA,OAAO,IAAI;EACZ;EAEA,OAAO,KAAK;AACb,CAAC;AAED,MAAM;EAAEI,KAAK;EAAEC;AAAQ,CAAC,GAAGjC,+DAAK,CAAE,4BAA4B,EAAE;EAC/DgC,KAAK,EAAE;IACNE,SAAS,EAAE,KAAK;IAChBC,YAAY,EAAE,IAAI;IAClBC,cAAc,EAAExB,mBAAmB,CAClCV,YAAY,CAACC,IAAI,CAAEe,gBAAgB,CAAC,CAAE,CAAC,EACvC,IACD,CAAC;IACDmB,SAAS,EAAE,IAAI;IACfC,MAAM,EAAE,EAAE;IACVC,YAAY,EAAE3B,mBAAmB,CAChCV,YAAY,CAACG,KAAK,CAAEa,gBAAgB,CAAC,CAAE,CAAC,EACxC,CACD,CAAC;IACDsB,YAAY,EAAE5B,mBAAmB,CAChCV,YAAY,CAACI,KAAK,CAAEY,gBAAgB,CAAC,CAAE,CAAC,EACxC,CACD,CAAC;IACDuB,iBAAiB,EAAE;MAAEC,YAAY,EAAE;IAAM,CAAC;IAC1CC,YAAY,EAAE,CAAC;IACfC,UAAU,EAAE,EAAE;IACdC,kBAAkB,EAAE,KAAK;IACzBC,sBAAsB,EAAE;EACzB,CAAC;EACDb,OAAO,EAAE;IACR;IACAc,mBAAmBA,CAAA,EAAG;MACrB,OAAO,IAAIC,OAAO,CAAIC,OAAO,IAAM;QAClC,MAAMC,KAAK,GAAGA,CAAA,KAAM;UACnB,IACC,CAAEnC,MAAM,CAACoC,eAAe,CAACC,QAAQ,IACjC,CAAErC,MAAM,CAACoC,eAAe,CAACE,OAAO,EAC/B;YACDJ,OAAO,CAAC,CAAC;UACV,CAAC,MAAM;YACNK,UAAU,CAAEJ,KAAK,EAAE,GAAI,CAAC;UACzB;QACD,CAAC;QACDA,KAAK,CAAC,CAAC;MACR,CAAE,CAAC;IACJ,CAAC;IAED;IACAK,eAAeA,CAAA,EAAG;MACjB,MAAMC,WAAW,GAAGjC,cAAc,CAAC,CAAC;MACpC,IAAK,CAAEiC,WAAW,EAAG;QACpB;MACD;MAEA,MAAMC,WAAW,GAAGD,WAAW,CAACE,gBAAgB,CAC/C,gCACD,CAAC;MACDD,WAAW,CAACE,OAAO,CAAIC,EAAE,IAAM;QAC9B,MAAMC,MAAM,GAAGD,EAAE,CAACE,UAAU;QAC5BD,MAAM,CAACE,YAAY,CAClB5C,QAAQ,CAAC6C,cAAc,CAAEJ,EAAE,CAACK,WAAY,CAAC,EACzCL,EACD,CAAC;MACF,CAAE,CAAC;IACJ,CAAC;IAEDM,sBAAsBA,CAAEC,UAAU,EAAEC,KAAK,EAAG;MAC3C,MAAMC,OAAO,GAAGlD,QAAQ,CAACmD,aAAa,CAAE,MAAO,CAAC;MAChDD,OAAO,CAACE,SAAS,GAAG,+BAA+B;MACnDF,OAAO,CAACG,KAAK,CAACC,eAAe,GAAGN,UAAU;MAC1CE,OAAO,CAACG,KAAK,CAACJ,KAAK,GAAGA,KAAK;MAC3B,OAAOC,OAAO;IACf,CAAC;IAED;IACA,MAAMK,UAAUA,CAAA,EAAG;MAClB,MAAMC,eAAe,GAAG5D,MAAM,CAACoC,eAAe,CAACyB,SAAS,CAAC,CAAC;MAC1D,IAAK,CAAED,eAAe,EAAEE,MAAM,EAAG;QAChCvB,UAAU,CAAE,MAAMrB,OAAO,CAACyC,UAAU,CAAC,CAAC,EAAE,GAAI,CAAC;QAC7C;MACD;MAEA,MAAMI,aAAa,GAAG5D,gBAAgB,CAAC,CAAC;MACxC,MAAM6D,WAAW,GAAGJ,eAAe,CAACK,MAAM,CAAIC,KAAK,IAClDA,KAAK,CAAC7E,IAAI,CAAC8E,UAAU,CAAEJ,aAAc,CACtC,CAAC;MAED9C,KAAK,CAACM,MAAM,GACXyC,WAAW,CAACF,MAAM,GAAG,CAAC,GAAGE,WAAW,GAAGJ,eAAe;MACvD3C,KAAK,CAACG,YAAY,GAAGH,KAAK,CAACM,MAAM,CAAE,CAAC,CAAE;MAEtC,IAAKN,KAAK,CAACI,cAAc,EAAG;QAC3B,MAAM6C,KAAK,GAAGjD,KAAK,CAACM,MAAM,CAAC6C,IAAI,CAC5BC,CAAC,IAAMA,CAAC,CAACC,QAAQ,KAAKrD,KAAK,CAACI,cAC/B,CAAC;QACD,IAAK6C,KAAK,EAAG;UACZjD,KAAK,CAACG,YAAY,GAAG8C,KAAK;QAC3B;MACD;MAEA3B,UAAU,CAAE,MAAMrB,OAAO,CAACqD,eAAe,CAAC,CAAC,EAAE,EAAG,CAAC;IAClD,CAAC;IAED;IACAA,eAAeA,CAAA,EAAG;MACjB,MAAMC,OAAO,GACZvD,KAAK,CAACY,UAAU,CAACiC,MAAM,GAAG,CAAC,GACxB7C,KAAK,CAACY,UAAU,CAAEZ,KAAK,CAACW,YAAY,CAAE,GACtCV,OAAO,CAACuD,UAAU,CAAC,CAAC;MAExB,MAAMC,YAAY,GAAG,IAAI1E,MAAM,CAAC2E,wBAAwB,CAAEH,OAAQ,CAAC;MACnEE,YAAY,CAACrF,IAAI,GAAGc,gBAAgB,CAAC,CAAC;MACtCuE,YAAY,CAACE,IAAI,GAAG3D,KAAK,CAACO,YAAY;MACtCkD,YAAY,CAACG,KAAK,GAAG5D,KAAK,CAACQ,YAAY;MAEvC,IAAKR,KAAK,CAACG,YAAY,EAAG;QACzB,MAAM8C,KAAK,GAAGjD,KAAK,CAACM,MAAM,CAAC6C,IAAI,CAC5BC,CAAC,IAAMA,CAAC,CAACC,QAAQ,KAAKrD,KAAK,CAACG,YAAY,CAACkD,QAC5C,CAAC;QACDI,YAAY,CAACR,KAAK,GAAGA,KAAK;MAC3B;MAEAhD,OAAO,CAAC4D,oBAAoB,CAAEJ,YAAY,EAAEF,OAAQ,CAAC;MACrDvD,KAAK,CAACK,SAAS,GAAGoD,YAAY;IAC/B,CAAC;IAEDI,oBAAoBA,CAAExD,SAAS,EAAEkD,OAAO,EAAG;MAC1ClD,SAAS,CAACyD,UAAU,GAAKC,KAAK,IAC7B9D,OAAO,CAAC+D,mBAAmB,CAAED,KAAK,EAAER,OAAQ,CAAC;MAC9ClD,SAAS,CAAC4D,KAAK,GAAG,MAAMhE,OAAO,CAACiE,kBAAkB,CAAC,CAAC;IACrD,CAAC;IAED;IACA,MAAMC,IAAIA,CAAA,EAAG;MACZ,MAAMC,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAAClE,SAAS,GAAG,IAAI;MACxBF,KAAK,CAACE,SAAS,GAAG,IAAI;MAEtB,IAAKF,KAAK,CAACY,UAAU,CAACiC,MAAM,KAAK,CAAC,IAAI7C,KAAK,CAACW,YAAY,KAAK,CAAC,EAAG;QAChEV,OAAO,CAACuD,UAAU,CAAC,CAAC;QACpBvD,OAAO,CAACqD,eAAe,CAAC,CAAC;MAC1B;MAEA,IAAKvE,MAAM,CAACoC,eAAe,CAACkD,MAAM,EAAG;QACpCtF,MAAM,CAACoC,eAAe,CAACmD,MAAM,CAAC,CAAC;QAC/B;MACD;;MAEA;MACA,IAAKvF,MAAM,CAACoC,eAAe,CAACC,QAAQ,EAAG;QACtCrC,MAAM,CAACoC,eAAe,CAACoD,MAAM,CAAC,CAAC;QAC/BjD,UAAU,CAAE,MAAM;UACjB,IAAKtB,KAAK,CAACK,SAAS,EAAG;YACtBtB,MAAM,CAACoC,eAAe,CAACqD,KAAK,CAAExE,KAAK,CAACK,SAAU,CAAC;UAChD;QACD,CAAC,EAAE,EAAG,CAAC;QACP;MACD;MAEA,IAAKL,KAAK,CAACK,SAAS,EAAG;QACtBtB,MAAM,CAACoC,eAAe,CAACqD,KAAK,CAAExE,KAAK,CAACK,SAAU,CAAC;MAChD;IACD,CAAC;IAEDoE,KAAKA,CAAA,EAAG;MACP,MAAML,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAAClE,SAAS,GAAG,KAAK;MACzBF,KAAK,CAACE,SAAS,GAAG,KAAK;;MAEvB;MACA,IACCnB,MAAM,CAACoC,eAAe,CAACC,QAAQ,IAC/B,CAAErC,MAAM,CAACoC,eAAe,CAACkD,MAAM,EAC9B;QACDtF,MAAM,CAACoC,eAAe,CAACuD,KAAK,CAAC,CAAC;MAC/B;IACD,CAAC;IACDC,OAAOA,CAAA,EAAG;MACT,MAAMP,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAAClE,SAAS,GAAG,KAAK;MACzBF,KAAK,CAACE,SAAS,GAAG,KAAK;MACvBnB,MAAM,CAACoC,eAAe,CAACoD,MAAM,CAAC,CAAC;MAE/BvE,KAAK,CAACW,YAAY,GAAG,CAAC;MACtBX,KAAK,CAACY,UAAU,GAAG,EAAE;MAErBX,OAAO,CAACsB,eAAe,CAAC,CAAC;IAC1B,CAAC;IACDqD,WAAWA,CAAEC,CAAC,EAAG;MAChB,MAAMT,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAAClE,SAAS,GAAG,KAAK;;MAEzB;MACAnB,MAAM,CAACoC,eAAe,CAACoD,MAAM,CAAC,CAAC;MAE/B,MAAMtB,KAAK,GAAGjD,KAAK,CAACM,MAAM,CAAC6C,IAAI,CAC5BC,CAAC,IAAMA,CAAC,CAACC,QAAQ,KAAKwB,CAAC,CAACC,MAAM,CAACC,KAClC,CAAC;MAED,IAAK9B,KAAK,EAAG;QACZjD,KAAK,CAACG,YAAY,GAAG8C,KAAK;QAC1BlE,MAAM,CAACC,YAAY,CAACgG,OAAO,CAC1B,iBAAiB,GAAG7F,QAAQ,CAACC,eAAe,CAAChB,IAAI,EACjD6E,KAAK,CAACI,QACP,CAAC;;QAED;QACA/B,UAAU,CAAE,MAAM;UACjBrB,OAAO,CAACgF,eAAe,CAAC,CAAC;QAC1B,CAAC,EAAE,EAAG,CAAC;MACR;IACD,CAAC;IACD,MAAMC,WAAWA,CAAEL,CAAC,EAAG;MACtB,MAAMT,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAAClE,SAAS,GAAG,KAAK;MACzBnB,MAAM,CAACoC,eAAe,CAACoD,MAAM,CAAC,CAAC;MAE/BvE,KAAK,CAACO,YAAY,GAAGsE,CAAC,CAACC,MAAM,CAACC,KAAK;MACnChG,MAAM,CAACC,YAAY,CAACgG,OAAO,CAC1B,kBAAkB,GAAG7F,QAAQ,CAACC,eAAe,CAAChB,IAAI,EAClDyG,CAAC,CAACC,MAAM,CAACC,KACV,CAAC;MAED,MAAM9E,OAAO,CAACc,mBAAmB,CAAC,CAAC;MACnCd,OAAO,CAACqD,eAAe,CAAC,CAAC;MAEzB,IAAKc,OAAO,CAAClE,SAAS,EAAG;QACxBoB,UAAU,CAAE,MAAM;UACjBvC,MAAM,CAACoC,eAAe,CAACqD,KAAK,CAAExE,KAAK,CAACK,SAAU,CAAC;QAChD,CAAC,EAAE,EAAG,CAAC;MACR;IACD,CAAC;IACD,MAAM8E,WAAWA,CAAEN,CAAC,EAAG;MACtB,MAAMT,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAAClE,SAAS,GAAG,KAAK;MACzBnB,MAAM,CAACoC,eAAe,CAACoD,MAAM,CAAC,CAAC;MAE/BvE,KAAK,CAACQ,YAAY,GAAGqE,CAAC,CAACC,MAAM,CAACC,KAAK;MACnChG,MAAM,CAACC,YAAY,CAACgG,OAAO,CAC1B,kBAAkB,GAAG7F,QAAQ,CAACC,eAAe,CAAChB,IAAI,EAClDyG,CAAC,CAACC,MAAM,CAACC,KACV,CAAC;MAED,MAAM9E,OAAO,CAACc,mBAAmB,CAAC,CAAC;MACnCd,OAAO,CAACqD,eAAe,CAAC,CAAC;MAEzB,IAAKc,OAAO,CAAClE,SAAS,EAAG;QACxBoB,UAAU,CAAE,MAAM;UACjBvC,MAAM,CAACoC,eAAe,CAACqD,KAAK,CAAExE,KAAK,CAACK,SAAU,CAAC;QAChD,CAAC,EAAE,EAAG,CAAC;MACR;IACD,CAAC;IACD+E,cAAcA,CAAA,EAAG;MAChB,MAAMhB,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAACiB,YAAY,GAAG,CAAEjB,OAAO,CAACiB,YAAY;IAC9C,CAAC;IACD7B,UAAUA,CAAA,EAAG;MACZ;MACA,MAAMhC,WAAW,GAAGjC,cAAc,CAAC,CAAC;MACpC,MAAM+F,OAAO,GAAG9D,WAAW,EAAE+D,aAAa,CAACC,WAAW;MACtD,MAAMC,SAAS,GAAGH,OAAO,GAAGA,OAAO,CAACI,YAAY,CAAC,CAAC,GAAG,IAAI;MACzD,IAAInC,OAAO,GAAG,EAAE;MAEhB,IAAKkC,SAAS,IAAIA,SAAS,CAACE,QAAQ,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC/C,MAAM,GAAG,CAAC,EAAG;QAC1D;QACAU,OAAO,GAAGkC,SAAS,CAACE,QAAQ,CAAC,CAAC;QAC9B3F,KAAK,CAACS,iBAAiB,GAAG;UACzBoF,IAAI,EAAEtC,OAAO;UACb7C,YAAY,EAAE;QACf,CAAC;MACF,CAAC,MAAM;QACN;QACA,IAAIoF,SAAS,GAAGtE,WAAW,EAAEuE,SAAS,CAAE,IAAK,CAAC;QAC9C,IAAKD,SAAS,EAAG;UAChB;UACA,MAAME,YAAY,GAAG3G,eAAe,CAAC,CAAC;UACtC,MAAM4G,iBAAiB,GACtBD,YAAY,EAAEE,OAAO,CAACC,YAAY,IAClC5H,QAAQ,CAACG,aAAa;UACvB,MAAM0H,cAAc,GAAGH,iBAAiB,CAACI,KAAK,CAAE,KAAM,CAAC;;UAEvD;UACAD,cAAc,CAACzE,OAAO,CAAIwE,YAAY,IAAM;YAC3C,IAAKA,YAAY,EAAG;cACnB,MAAMG,IAAI,GAAGR,SAAS,CAACpE,gBAAgB,CACtC,IAAKyE,YAAY,EAClB,CAAC;cACDG,IAAI,CAAC3E,OAAO,CAAIC,EAAE,IAAM;gBACvBA,EAAE,CAAC2E,MAAM,CAAC,CAAC;cACZ,CAAE,CAAC;YACJ;UACD,CAAE,CAAC;UAEHhD,OAAO,GAAGuC,SAAS,CAAC7D,WAAW;UAC/B6D,SAAS,GAAG,IAAI;QACjB;QAEA9F,KAAK,CAACS,iBAAiB,GAAG;UACzBC,YAAY,EAAE;QACf,CAAC;MACF;;MAEA;MACAV,KAAK,CAACY,UAAU,GAAGX,OAAO,CAACuG,SAAS,CACnCjD,OAAO,EACPhF,QAAQ,CAACI,eACV,CAAC;MACDqB,KAAK,CAACW,YAAY,GAAG,CAAC;;MAEtB;MACA,OAAOX,KAAK,CAACY,UAAU,CAACiC,MAAM,GAAG,CAAC,GAAG7C,KAAK,CAACY,UAAU,CAAE,CAAC,CAAE,GAAG,EAAE;IAChE,CAAC;IACD;IACA4F,SAASA,CAAEX,IAAI,EAAEY,aAAa,EAAG;MAChC,IAAK,CAAEZ,IAAI,IAAIA,IAAI,CAACD,IAAI,CAAC,CAAC,KAAK,EAAE,EAAG;QACnC,OAAO,CAAE,EAAE,CAAE;MACd;;MAEA;MACA,MAAMc,KAAK,GAAGb,IAAI,CAACD,IAAI,CAAC,CAAC,CAACS,KAAK,CAAE,KAAM,CAAC;MACxC,MAAMM,MAAM,GAAG,EAAE;;MAEjB;MACA,KAAM,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,KAAK,CAAC7D,MAAM,EAAE+D,CAAC,IAAIH,aAAa,EAAG;QACvD,MAAMI,KAAK,GAAGH,KAAK,CAACI,KAAK,CAAEF,CAAC,EAAEA,CAAC,GAAGH,aAAc,CAAC,CAACM,IAAI,CAAE,GAAI,CAAC;QAC7DJ,MAAM,CAACK,IAAI,CAAEH,KAAM,CAAC;MACrB;MAEA,OAAOF,MAAM;IACd,CAAC;IACD3C,mBAAmBA,CAAED,KAAK,EAAER,OAAO,EAAG;MACrC,MAAM/B,WAAW,GAAGjC,cAAc,CAAC,CAAC;MACpC,IAAK,CAAEiC,WAAW,EAAG;QACpB;MACD;;MAEA;MACA,IACC,CAAEuC,KAAK,CAACkD,SAAS,IACjB,CAAElD,KAAK,CAACmD,UAAU,IAClBnD,KAAK,CAACkD,SAAS,GAAGlD,KAAK,CAACmD,UAAU,GAAG3D,OAAO,CAACV,MAAM,EAClD;QACD;MACD;MAEA,IAAI;QACH,MAAMmD,YAAY,GAAG3G,eAAe,CAAC,CAAC;QACtC,MAAM8H,mBAAmB,GACxBnB,YAAY,EAAEE,OAAO,CAACiB,mBAAmB,IACzC5I,QAAQ,CAACC,YAAY;QACtB,MAAM4I,cAAc,GACnBpB,YAAY,EAAEE,OAAO,CAACkB,cAAc,IACpC7I,QAAQ,CAACE,eAAe;QAEzB,IAAKuB,KAAK,CAACS,iBAAiB,EAAEC,YAAY,EAAG;UAC5C;UACA,MAAM4E,OAAO,GAAG9D,WAAW,EAAE+D,aAAa,CAACC,WAAW;UACtD,MAAMC,SAAS,GAAGH,OAAO,EAAEI,YAAY,CAAC,CAAC;UAEzC,IAAKD,SAAS,EAAE4B,UAAU,GAAG,CAAC,EAAG;YAChC,MAAMC,cAAc,GAAG7B,SAAS,CAAC8B,UAAU,CAAE,CAAE,CAAC;YAChD,MAAMlF,OAAO,GAAGpC,OAAO,CAACiC,sBAAsB,CAC7CiF,mBAAmB,EACnBC,cACD,CAAC;YACD,IAAI;cACHE,cAAc,CAACE,gBAAgB,CAAEnF,OAAQ,CAAC;YAC3C,CAAC,CAAC,OAAQwC,CAAC,EAAG;cACb;cACA,MAAM5C,WAAW,GAAGqF,cAAc,CAAC3B,QAAQ,CAAC,CAAC;cAC7CtD,OAAO,CAACJ,WAAW,GAAGA,WAAW;cACjCqF,cAAc,CAACG,cAAc,CAAC,CAAC;cAC/BH,cAAc,CAACI,UAAU,CAAErF,OAAQ,CAAC;YACrC;UACD;QACD,CAAC,MAAM;UACN;UACA,MAAM4D,iBAAiB,GACtBD,YAAY,EAAEE,OAAO,CAACC,YAAY,IAClC5H,QAAQ,CAACG,aAAa;UACvB,MAAM0H,cAAc,GAAGH,iBAAiB,CAACI,KAAK,CAAE,KAAM,CAAC;;UAEvD;UACA,MAAMsB,MAAM,GAAGxI,QAAQ,CAACyI,gBAAgB,CACvCpG,WAAW,EACXqG,UAAU,CAACC,SAAS,EACpB;YACCC,UAAUA,CAAEtI,IAAI,EAAG;cAClB;cACA,IAAIuI,OAAO,GAAGvI,IAAI,CAACwI,aAAa;cAChC,OAAQD,OAAO,EAAG;gBACjB,IAAKA,OAAO,CAACE,SAAS,EAAG;kBACxB,KAAM,MAAM/B,YAAY,IAAIC,cAAc,EAAG;oBAC5C,IACCD,YAAY,IACZ6B,OAAO,CAACE,SAAS,CAACC,QAAQ,CACzBhC,YACD,CAAC,EACA;sBACD,OAAO0B,UAAU,CAACO,aAAa;oBAChC;kBACD;gBACD;gBACAJ,OAAO,GAAGA,OAAO,CAACC,aAAa;cAChC;cACA,OAAOJ,UAAU,CAACQ,aAAa;YAChC;UACD,CACD,CAAC;;UAED;UACA,IAAIC,SAAS,GAAG,CAAC;UACjB,IAAIC,UAAU,GAAG,IAAI;UACrB,IAAI9I,IAAI;UAER,OAAUA,IAAI,GAAGkI,MAAM,CAACa,QAAQ,CAAC,CAAC,EAAK;YACtC,MAAMC,UAAU,GAAGhJ,IAAI,CAACwC,WAAW,CAACY,MAAM;YAC1C,IACCyF,SAAS,IAAIvE,KAAK,CAACkD,SAAS,IAC5BlD,KAAK,CAACkD,SAAS,GAAGqB,SAAS,GAAGG,UAAU,IACxCjJ,UAAU,CAAEC,IAAK,CAAC,EACjB;cACD8I,UAAU,GAAG9I,IAAI;cACjB;YACD;YACA6I,SAAS,IAAIG,UAAU;UACxB;;UAEA;UACA,IACCF,UAAU,IACVA,UAAU,KAAKvI,KAAK,CAACc,sBAAsB,IAC3CyH,UAAU,CAACtG,WAAW,CAAC2D,IAAI,CAAC,CAAC,CAAC/C,MAAM,GAAG,CAAC,EACvC;YACD;YACA5C,OAAO,CAACsB,eAAe,CAAC,CAAC;;YAEzB;YACA,MAAMc,OAAO,GAAGpC,OAAO,CAACiC,sBAAsB,CAC7CiF,mBAAmB,EACnBC,cACD,CAAC;YACD/E,OAAO,CAACJ,WAAW,GAAGsG,UAAU,CAACtG,WAAW;YAC5CsG,UAAU,CAACzG,UAAU,CAACC,YAAY,CACjCM,OAAO,EACPkG,UACD,CAAC;;YAED;YACAvI,KAAK,CAACc,sBAAsB,GAAGuB,OAAO,CAACqG,UAAU;UAClD;QACD;MACD,CAAC,CAAC,OAAQ7D,CAAC,EAAG;QACb8D,OAAO,CAACC,KAAK,CAAE,qBAAqB,EAAE/D,CAAE,CAAC;MAC1C;IACD,CAAC;IACDX,kBAAkBA,CAAA,EAAG;MACpB;MACAjE,OAAO,CAACsB,eAAe,CAAC,CAAC;;MAEzB;MACA,MAAM6C,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5BmG,OAAO,CAAClE,SAAS,GAAG,KAAK;MACzBF,KAAK,CAACE,SAAS,GAAG,KAAK;;MAEvB;MACAF,KAAK,CAACW,YAAY,GAAG,CAAC;MACtBX,KAAK,CAACY,UAAU,GAAG,EAAE;;MAErB;MACAZ,KAAK,CAACc,sBAAsB,GAAG,IAAI;;MAEnC;MACAd,KAAK,CAACS,iBAAiB,GAAG;QACzBC,YAAY,EAAE;MACf,CAAC;IACF;EACD,CAAC;EACDmI,SAAS,EAAE;IACVC,IAAIA,CAAA,EAAG;MACN,IAAK,CAAE/J,MAAM,CAACoC,eAAe,EAAG;QAC/B;MACD;MAEApC,MAAM,CAACoC,eAAe,CAACoD,MAAM,CAAC,CAAC;MAC/BtE,OAAO,CAACyC,UAAU,CAAC,CAAC;MAEpB,IAAK3D,MAAM,CAACoC,eAAe,CAAC4H,eAAe,KAAKC,SAAS,EAAG;QAC3DjK,MAAM,CAACoC,eAAe,CAAC4H,eAAe,GAAG9I,OAAO,CAACyC,UAAU;MAC5D;MAEA3D,MAAM,CAACkK,gBAAgB,CAAE,cAAc,EAAE,MAAM;QAC9ClK,MAAM,CAACoC,eAAe,CAACoD,MAAM,CAAC,CAAC;MAChC,CAAE,CAAC;IACJ,CAAC;IACD2E,UAAUA,CAAA,EAAG;MACZ,MAAM9E,OAAO,GAAGnG,oEAAU,CAAC,CAAC;MAC5B,OAAOmG,OAAO,CAACnB,KAAK,CAACI,QAAQ,KAAKrD,KAAK,CAACG,YAAY,CAACkD,QAAQ;IAC9D;EACD;AACD,CAAE,CAAC,C","sources":["webpack://mosne-text-to-speech-block/external module \"@wordpress/interactivity\"","webpack://mosne-text-to-speech-block/webpack/bootstrap","webpack://mosne-text-to-speech-block/webpack/runtime/make namespace object","webpack://mosne-text-to-speech-block/./src/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store, getContext } from '@wordpress/interactivity';\n\n// Constants\nconst STORAGE_KEYS = {\n\tLANG: ( lang ) => `mosne-tts-lang-${ lang }`,\n\tSPEED: ( lang ) => `mosne-tts-speed-${ lang }`,\n\tPITCH: ( lang ) => `mosne-tts-pitch-${ lang }`,\n};\n\nconst DEFAULTS = {\n\tHIGHLIGHT_BG: '#ffeb3b',\n\tHIGHLIGHT_COLOR: '#000000',\n\tEXCLUDE_CLASS: 'skip-speech',\n\tWORDS_PER_CHUNK: 200,\n};\n\n// Helper functions\nconst getLocalStorageItem = ( key, defaultValue ) =>\n\twindow.localStorage.getItem( key ) || defaultValue;\n\nconst getCurrentLocale = () => document.documentElement.lang;\n\nconst getBlockWrapper = () =>\n\tdocument.querySelector(\n\t\t'[data-wp-interactive=\"mosne-text-to-speech-block\"]'\n\t);\n\nconst getMainElement = () => document.querySelector( 'main' );\n\nconst isLeafNode = ( node ) => {\n\t// Check if this is a text node\n\tif ( node.nodeType === Node.TEXT_NODE ) {\n\t\treturn true;\n\t}\n\n\t// For element nodes, check if they only contain text nodes (no other elements)\n\tif ( node.nodeType === Node.ELEMENT_NODE ) {\n\t\tfor ( const child of node.childNodes ) {\n\t\t\tif ( child.nodeType !== Node.TEXT_NODE ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\nconst { state, actions } = store( 'mosne-text-to-speech-block', {\n\tstate: {\n\t\tisPlaying: false,\n\t\tcurrentVoice: null,\n\t\tpreferredVoice: getLocalStorageItem(\n\t\t\tSTORAGE_KEYS.LANG( getCurrentLocale() ),\n\t\t\tnull\n\t\t),\n\t\tutterance: null,\n\t\tvoices: [],\n\t\tcurrentSpeed: getLocalStorageItem(\n\t\t\tSTORAGE_KEYS.SPEED( getCurrentLocale() ),\n\t\t\t1\n\t\t),\n\t\tcurrentPitch: getLocalStorageItem(\n\t\t\tSTORAGE_KEYS.PITCH( getCurrentLocale() ),\n\t\t\t1\n\t\t),\n\t\tselectedTextRange: { hasSelection: false },\n\t\tcurrentChunk: 0,\n\t\ttextChunks: [],\n\t\tisProcessingChunks: false,\n\t\tcurrentHighlightedNode: null,\n\t},\n\tactions: {\n\t\t// Speech Synthesis Management\n\t\tcheckSynthesisReady() {\n\t\t\treturn new Promise( ( resolve ) => {\n\t\t\t\tconst check = () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t! window.speechSynthesis.speaking &&\n\t\t\t\t\t\t! window.speechSynthesis.pending\n\t\t\t\t\t) {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetTimeout( check, 100 );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tcheck();\n\t\t\t} );\n\t\t},\n\n\t\t// Highlighting Management\n\t\tclearHighlights() {\n\t\t\tconst mainElement = getMainElement();\n\t\t\tif ( ! mainElement ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst highlighted = mainElement.querySelectorAll(\n\t\t\t\t'.mosne-tts-highlighted-section'\n\t\t\t);\n\t\t\thighlighted.forEach( ( el ) => {\n\t\t\t\tconst parent = el.parentNode;\n\t\t\t\tparent.replaceChild(\n\t\t\t\t\tdocument.createTextNode( el.textContent ),\n\t\t\t\t\tel\n\t\t\t\t);\n\t\t\t} );\n\t\t},\n\n\t\tcreateHighlightWrapper( background, color ) {\n\t\t\tconst wrapper = document.createElement( 'span' );\n\t\t\twrapper.className = 'mosne-tts-highlighted-section';\n\t\t\twrapper.style.backgroundColor = background;\n\t\t\twrapper.style.color = color;\n\t\t\treturn wrapper;\n\t\t},\n\n\t\t// Voice Management\n\t\tasync loadVoices() {\n\t\t\tconst availableVoices = window.speechSynthesis.getVoices();\n\t\t\tif ( ! availableVoices?.length ) {\n\t\t\t\tsetTimeout( () => actions.loadVoices(), 100 );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentLocale = getCurrentLocale();\n\t\t\tconst localVoices = availableVoices.filter( ( voice ) =>\n\t\t\t\tvoice.lang.startsWith( currentLocale )\n\t\t\t);\n\n\t\t\tstate.voices =\n\t\t\t\tlocalVoices.length > 0 ? localVoices : availableVoices;\n\t\t\tstate.currentVoice = state.voices[ 0 ];\n\n\t\t\tif ( state.preferredVoice ) {\n\t\t\t\tconst voice = state.voices.find(\n\t\t\t\t\t( v ) => v.voiceURI === state.preferredVoice\n\t\t\t\t);\n\t\t\t\tif ( voice ) {\n\t\t\t\t\tstate.currentVoice = voice;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout( () => actions.createUtterance(), 50 );\n\t\t},\n\n\t\t// Utterance Management\n\t\tcreateUtterance() {\n\t\t\tconst content =\n\t\t\t\tstate.textChunks.length > 0\n\t\t\t\t\t? state.textChunks[ state.currentChunk ]\n\t\t\t\t\t: actions.getContent();\n\n\t\t\tconst newUtterance = new window.SpeechSynthesisUtterance( content );\n\t\t\tnewUtterance.lang = getCurrentLocale();\n\t\t\tnewUtterance.rate = state.currentSpeed;\n\t\t\tnewUtterance.pitch = state.currentPitch;\n\n\t\t\tif ( state.currentVoice ) {\n\t\t\t\tconst voice = state.voices.find(\n\t\t\t\t\t( v ) => v.voiceURI === state.currentVoice.voiceURI\n\t\t\t\t);\n\t\t\t\tnewUtterance.voice = voice;\n\t\t\t}\n\n\t\t\tactions.setupUtteranceEvents( newUtterance, content );\n\t\t\tstate.utterance = newUtterance;\n\t\t},\n\n\t\tsetupUtteranceEvents( utterance, content ) {\n\t\t\tutterance.onboundary = ( event ) =>\n\t\t\t\tactions.handleBoundaryEvent( event, content );\n\t\t\tutterance.onend = () => actions.handleUtteranceEnd();\n\t\t},\n\n\t\t// Playback Controls\n\t\tasync Play() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = true;\n\t\t\tstate.isPlaying = true;\n\n\t\t\tif ( state.textChunks.length === 0 || state.currentChunk === 0 ) {\n\t\t\t\tactions.getContent();\n\t\t\t\tactions.createUtterance();\n\t\t\t}\n\n\t\t\tif ( window.speechSynthesis.paused ) {\n\t\t\t\twindow.speechSynthesis.resume();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Chrome fix\n\t\t\tif ( window.speechSynthesis.speaking ) {\n\t\t\t\twindow.speechSynthesis.cancel();\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tif ( state.utterance ) {\n\t\t\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t\t\t}\n\t\t\t\t}, 50 );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( state.utterance ) {\n\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t}\n\t\t},\n\n\t\tPause() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\tstate.isPlaying = false;\n\n\t\t\t// Only pause if currently speaking and the browser supports pausing\n\t\t\tif (\n\t\t\t\twindow.speechSynthesis.speaking &&\n\t\t\t\t! window.speechSynthesis.paused\n\t\t\t) {\n\t\t\t\twindow.speechSynthesis.pause();\n\t\t\t}\n\t\t},\n\t\tRestart() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\tstate.isPlaying = false;\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tstate.currentChunk = 0;\n\t\t\tstate.textChunks = [];\n\n\t\t\tactions.clearHighlights();\n\t\t},\n\t\tchangeVoice( e ) {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\n\t\t\t// Cancel any ongoing speech\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tconst voice = state.voices.find(\n\t\t\t\t( v ) => v.voiceURI === e.target.value\n\t\t\t);\n\n\t\t\tif ( voice ) {\n\t\t\t\tstate.currentVoice = voice;\n\t\t\t\twindow.localStorage.setItem(\n\t\t\t\t\t'mosne-tts-lang-' + document.documentElement.lang,\n\t\t\t\t\tvoice.voiceURI\n\t\t\t\t);\n\n\t\t\t\t// Small delay to ensure speech synthesis is ready\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tactions.updateUtterance();\n\t\t\t\t}, 50 );\n\t\t\t}\n\t\t},\n\t\tasync changeSpeed( e ) {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tstate.currentSpeed = e.target.value;\n\t\t\twindow.localStorage.setItem(\n\t\t\t\t'mosne-tts-speed-' + document.documentElement.lang,\n\t\t\t\te.target.value\n\t\t\t);\n\n\t\t\tawait actions.checkSynthesisReady();\n\t\t\tactions.createUtterance();\n\n\t\t\tif ( context.isPlaying ) {\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t\t}, 50 );\n\t\t\t}\n\t\t},\n\t\tasync changePitch( e ) {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tstate.currentPitch = e.target.value;\n\t\t\twindow.localStorage.setItem(\n\t\t\t\t'mosne-tts-pitch-' + document.documentElement.lang,\n\t\t\t\te.target.value\n\t\t\t);\n\n\t\t\tawait actions.checkSynthesisReady();\n\t\t\tactions.createUtterance();\n\n\t\t\tif ( context.isPlaying ) {\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t\t}, 50 );\n\t\t\t}\n\t\t},\n\t\ttoggleSettings() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.showSettings = ! context.showSettings;\n\t\t},\n\t\tgetContent() {\n\t\t\t// Check if there is highlighted text\n\t\t\tconst mainElement = getMainElement();\n\t\t\tconst docView = mainElement?.ownerDocument.defaultView;\n\t\t\tconst selection = docView ? docView.getSelection() : null;\n\t\t\tlet content = '';\n\n\t\t\tif ( selection && selection.toString().trim().length > 0 ) {\n\t\t\t\t// Get selected text\n\t\t\t\tcontent = selection.toString();\n\t\t\t\tstate.selectedTextRange = {\n\t\t\t\t\ttext: content,\n\t\t\t\t\thasSelection: true,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\t// Get content from main element\n\t\t\t\tlet cloneMain = mainElement?.cloneNode( true );\n\t\t\t\tif ( cloneMain ) {\n\t\t\t\t\t// Use the same exclude classes logic for consistency\n\t\t\t\t\tconst blockWrapper = getBlockWrapper();\n\t\t\t\t\tconst excludeClassesStr =\n\t\t\t\t\t\tblockWrapper?.dataset.excludeClass ||\n\t\t\t\t\t\tDEFAULTS.EXCLUDE_CLASS;\n\t\t\t\t\tconst excludeClasses = excludeClassesStr.split( /\\s+/ );\n\n\t\t\t\t\t// Remove all elements with excluded classes\n\t\t\t\t\texcludeClasses.forEach( ( excludeClass ) => {\n\t\t\t\t\t\tif ( excludeClass ) {\n\t\t\t\t\t\t\tconst skip = cloneMain.querySelectorAll(\n\t\t\t\t\t\t\t\t`.${ excludeClass }`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tskip.forEach( ( el ) => {\n\t\t\t\t\t\t\t\tel.remove();\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\tcontent = cloneMain.textContent;\n\t\t\t\t\tcloneMain = null;\n\t\t\t\t}\n\n\t\t\t\tstate.selectedTextRange = {\n\t\t\t\t\thasSelection: false,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Process content into chunks of approximately 200 words\n\t\t\tstate.textChunks = actions.chunkText(\n\t\t\t\tcontent,\n\t\t\t\tDEFAULTS.WORDS_PER_CHUNK\n\t\t\t);\n\t\t\tstate.currentChunk = 0;\n\n\t\t\t// Return the first chunk to start with\n\t\t\treturn state.textChunks.length > 0 ? state.textChunks[ 0 ] : '';\n\t\t},\n\t\t// New method to chunk text into approximately word-sized pieces\n\t\tchunkText( text, wordsPerChunk ) {\n\t\t\tif ( ! text || text.trim() === '' ) {\n\t\t\t\treturn [ '' ];\n\t\t\t}\n\n\t\t\t// Split the text into words\n\t\t\tconst words = text.trim().split( /\\s+/ );\n\t\t\tconst chunks = [];\n\n\t\t\t// Create chunks of approximately wordsPerChunk words\n\t\t\tfor ( let i = 0; i < words.length; i += wordsPerChunk ) {\n\t\t\t\tconst chunk = words.slice( i, i + wordsPerChunk ).join( ' ' );\n\t\t\t\tchunks.push( chunk );\n\t\t\t}\n\n\t\t\treturn chunks;\n\t\t},\n\t\thandleBoundaryEvent( event, content ) {\n\t\t\tconst mainElement = getMainElement();\n\t\t\tif ( ! mainElement ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Safety check for valid boundary event\n\t\t\tif (\n\t\t\t\t! event.charIndex ||\n\t\t\t\t! event.charLength ||\n\t\t\t\tevent.charIndex + event.charLength > content.length\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst blockWrapper = getBlockWrapper();\n\t\t\t\tconst highlightBackground =\n\t\t\t\t\tblockWrapper?.dataset.highlightBackground ||\n\t\t\t\t\tDEFAULTS.HIGHLIGHT_BG;\n\t\t\t\tconst highlightColor =\n\t\t\t\t\tblockWrapper?.dataset.highlightColor ||\n\t\t\t\t\tDEFAULTS.HIGHLIGHT_COLOR;\n\n\t\t\t\tif ( state.selectedTextRange?.hasSelection ) {\n\t\t\t\t\t// Handle selected text highlighting\n\t\t\t\t\tconst docView = mainElement?.ownerDocument.defaultView;\n\t\t\t\t\tconst selection = docView?.getSelection();\n\n\t\t\t\t\tif ( selection?.rangeCount > 0 ) {\n\t\t\t\t\t\tconst selectionRange = selection.getRangeAt( 0 );\n\t\t\t\t\t\tconst wrapper = actions.createHighlightWrapper(\n\t\t\t\t\t\t\thighlightBackground,\n\t\t\t\t\t\t\thighlightColor\n\t\t\t\t\t\t);\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tselectionRange.surroundContents( wrapper );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t// Fallback for when surroundContents fails\n\t\t\t\t\t\t\tconst textContent = selectionRange.toString();\n\t\t\t\t\t\t\twrapper.textContent = textContent;\n\t\t\t\t\t\t\tselectionRange.deleteContents();\n\t\t\t\t\t\t\tselectionRange.insertNode( wrapper );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Handle main content highlighting\n\t\t\t\t\tconst excludeClassesStr =\n\t\t\t\t\t\tblockWrapper?.dataset.excludeClass ||\n\t\t\t\t\t\tDEFAULTS.EXCLUDE_CLASS;\n\t\t\t\t\tconst excludeClasses = excludeClassesStr.split( /\\s+/ );\n\n\t\t\t\t\t// Create TreeWalker to find text nodes\n\t\t\t\t\tconst walker = document.createTreeWalker(\n\t\t\t\t\t\tmainElement,\n\t\t\t\t\t\tNodeFilter.SHOW_TEXT,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tacceptNode( node ) {\n\t\t\t\t\t\t\t\t// Check if node's parent has excluded classes\n\t\t\t\t\t\t\t\tlet current = node.parentElement;\n\t\t\t\t\t\t\t\twhile ( current ) {\n\t\t\t\t\t\t\t\t\tif ( current.classList ) {\n\t\t\t\t\t\t\t\t\t\tfor ( const excludeClass of excludeClasses ) {\n\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\texcludeClass &&\n\t\t\t\t\t\t\t\t\t\t\t\tcurrent.classList.contains(\n\t\t\t\t\t\t\t\t\t\t\t\t\texcludeClass\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcurrent = current.parentElement;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// Find the node containing the current position\n\t\t\t\t\tlet charCount = 0;\n\t\t\t\t\tlet targetNode = null;\n\t\t\t\t\tlet node;\n\n\t\t\t\t\twhile ( ( node = walker.nextNode() ) ) {\n\t\t\t\t\t\tconst nodeLength = node.textContent.length;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tcharCount <= event.charIndex &&\n\t\t\t\t\t\t\tevent.charIndex < charCount + nodeLength &&\n\t\t\t\t\t\t\tisLeafNode( node )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\ttargetNode = node;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcharCount += nodeLength;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Only update highlight if we've found a new leaf node and it's different from the current one\n\t\t\t\t\tif (\n\t\t\t\t\t\ttargetNode &&\n\t\t\t\t\t\ttargetNode !== state.currentHighlightedNode &&\n\t\t\t\t\t\ttargetNode.textContent.trim().length > 0\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Clear previous highlight\n\t\t\t\t\t\tactions.clearHighlights();\n\n\t\t\t\t\t\t// Create new highlight\n\t\t\t\t\t\tconst wrapper = actions.createHighlightWrapper(\n\t\t\t\t\t\t\thighlightBackground,\n\t\t\t\t\t\t\thighlightColor\n\t\t\t\t\t\t);\n\t\t\t\t\t\twrapper.textContent = targetNode.textContent;\n\t\t\t\t\t\ttargetNode.parentNode.replaceChild(\n\t\t\t\t\t\t\twrapper,\n\t\t\t\t\t\t\ttargetNode\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// Update current node reference\n\t\t\t\t\t\tstate.currentHighlightedNode = wrapper.firstChild;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch ( e ) {\n\t\t\t\tconsole.error( 'Highlighting error:', e );\n\t\t\t}\n\t\t},\n\t\thandleUtteranceEnd() {\n\t\t\t// Clear any remaining highlights\n\t\t\tactions.clearHighlights();\n\n\t\t\t// Update playing state\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\tstate.isPlaying = false;\n\n\t\t\t// Reset chunk tracking\n\t\t\tstate.currentChunk = 0;\n\t\t\tstate.textChunks = [];\n\n\t\t\t// Reset highlight tracking\n\t\t\tstate.currentHighlightedNode = null;\n\n\t\t\t// Clear selected text range\n\t\t\tstate.selectedTextRange = {\n\t\t\t\thasSelection: false,\n\t\t\t};\n\t\t},\n\t},\n\tcallbacks: {\n\t\tinit() {\n\t\t\tif ( ! window.speechSynthesis ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twindow.speechSynthesis.cancel();\n\t\t\tactions.loadVoices();\n\n\t\t\tif ( window.speechSynthesis.onvoiceschanged !== undefined ) {\n\t\t\t\twindow.speechSynthesis.onvoiceschanged = actions.loadVoices;\n\t\t\t}\n\n\t\t\twindow.addEventListener( 'beforeunload', () => {\n\t\t\t\twindow.speechSynthesis.cancel();\n\t\t\t} );\n\t\t},\n\t\tisSelected() {\n\t\t\tconst context = getContext();\n\t\t\treturn context.voice.voiceURI === state.currentVoice.voiceURI;\n\t\t},\n\t},\n} );\n"],"names":["store","getContext","STORAGE_KEYS","LANG","lang","SPEED","PITCH","DEFAULTS","HIGHLIGHT_BG","HIGHLIGHT_COLOR","EXCLUDE_CLASS","WORDS_PER_CHUNK","getLocalStorageItem","key","defaultValue","window","localStorage","getItem","getCurrentLocale","document","documentElement","getBlockWrapper","querySelector","getMainElement","isLeafNode","node","nodeType","Node","TEXT_NODE","ELEMENT_NODE","child","childNodes","state","actions","isPlaying","currentVoice","preferredVoice","utterance","voices","currentSpeed","currentPitch","selectedTextRange","hasSelection","currentChunk","textChunks","isProcessingChunks","currentHighlightedNode","checkSynthesisReady","Promise","resolve","check","speechSynthesis","speaking","pending","setTimeout","clearHighlights","mainElement","highlighted","querySelectorAll","forEach","el","parent","parentNode","replaceChild","createTextNode","textContent","createHighlightWrapper","background","color","wrapper","createElement","className","style","backgroundColor","loadVoices","availableVoices","getVoices","length","currentLocale","localVoices","filter","voice","startsWith","find","v","voiceURI","createUtterance","content","getContent","newUtterance","SpeechSynthesisUtterance","rate","pitch","setupUtteranceEvents","onboundary","event","handleBoundaryEvent","onend","handleUtteranceEnd","Play","context","paused","resume","cancel","speak","Pause","pause","Restart","changeVoice","e","target","value","setItem","updateUtterance","changeSpeed","changePitch","toggleSettings","showSettings","docView","ownerDocument","defaultView","selection","getSelection","toString","trim","text","cloneMain","cloneNode","blockWrapper","excludeClassesStr","dataset","excludeClass","excludeClasses","split","skip","remove","chunkText","wordsPerChunk","words","chunks","i","chunk","slice","join","push","charIndex","charLength","highlightBackground","highlightColor","rangeCount","selectionRange","getRangeAt","surroundContents","deleteContents","insertNode","walker","createTreeWalker","NodeFilter","SHOW_TEXT","acceptNode","current","parentElement","classList","contains","FILTER_REJECT","FILTER_ACCEPT","charCount","targetNode","nextNode","nodeLength","firstChild","console","error","callbacks","init","onvoiceschanged","undefined","addEventListener","isSelected"],"sourceRoot":""}