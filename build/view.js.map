{"version":3,"file":"view.js","mappings":"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","sources":["webpack://mosne-text-to-speech-block/external module \"@wordpress/interactivity\"","webpack://mosne-text-to-speech-block/webpack/bootstrap","webpack://mosne-text-to-speech-block/webpack/runtime/make namespace object","webpack://mosne-text-to-speech-block/./src/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store, getContext } from '@wordpress/interactivity';\n\nconst { state, actions } = store( 'mosne-text-to-speech-block', {\n\tstate: {\n\t\tisPlaying: false,\n\t\tcurrentVoice: null,\n\t\tpreferredVoice:\n\t\t\twindow.localStorage.getItem(\n\t\t\t\t'mosne-tts-lang-' + document.documentElement.lang\n\t\t\t) || null,\n\t\tutterance: null,\n\t\tvoices: [],\n\t\tcurrentSpeed:\n\t\t\twindow.localStorage.getItem(\n\t\t\t\t'mosne-tts-speed-' + document.documentElement.lang\n\t\t\t) || 1,\n\t\tcurrentPitch:\n\t\t\twindow.localStorage.getItem(\n\t\t\t\t'mosne-tts-pitch-' + document.documentElement.lang\n\t\t\t) || 1,\n\t\tselectedTextRange: {\n\t\t\thasSelection: false,\n\t\t},\n\t\tcurrentChunk: 0,\n\t\ttextChunks: [],\n\t\tisProcessingChunks: false,\n\t},\n\tactions: {\n\t\tcheckSynthesisReady() {\n\t\t\treturn new Promise( ( resolve ) => {\n\t\t\t\tconst check = () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t! window.speechSynthesis.speaking &&\n\t\t\t\t\t\t! window.speechSynthesis.pending\n\t\t\t\t\t) {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetTimeout( check, 100 );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tcheck();\n\t\t\t} );\n\t\t},\n\t\tloadVoices() {\n\t\t\tconst availableVoices = window.speechSynthesis.getVoices();\n\t\t\tif ( ! availableVoices || availableVoices.length === 0 ) {\n\t\t\t\t// If voices aren't available yet, try again after a short delay\n\t\t\t\tsetTimeout( () => actions.loadVoices(), 100 );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tstate.voices = availableVoices;\n\t\t\tstate.currentVoice = availableVoices[ 0 ];\n\n\t\t\tconst currentLocale = document.documentElement.lang;\n\t\t\tconst localVoices = availableVoices.filter( ( voice ) =>\n\t\t\t\tvoice.lang.startsWith( currentLocale )\n\t\t\t);\n\n\t\t\tif ( localVoices.length > 0 ) {\n\t\t\t\tstate.voices = localVoices;\n\t\t\t\tstate.currentVoice = localVoices[ 0 ];\n\t\t\t\tif ( state.preferredVoice ) {\n\t\t\t\t\tconst voice = localVoices.find(\n\t\t\t\t\t\t( v ) => v.voiceURI === state.preferredVoice\n\t\t\t\t\t);\n\t\t\t\t\tif ( voice ) {\n\t\t\t\t\t\tstate.currentVoice = voice;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Create initial utterance after a small delay\n\t\t\tsetTimeout( () => {\n\t\t\t\tactions.createUtterance();\n\t\t\t}, 50 );\n\t\t},\n\t\tcreateUtterance() {\n\t\t\t// Get current chunk of content\n\t\t\tconst content =\n\t\t\t\tstate.textChunks.length > 0\n\t\t\t\t\t? state.textChunks[ state.currentChunk ]\n\t\t\t\t\t: actions.getContent();\n\n\t\t\tconst newUtterance = new window.SpeechSynthesisUtterance( content );\n\t\t\tnewUtterance.lang = document.documentElement.lang;\n\t\t\tnewUtterance.rate = state.currentSpeed;\n\t\t\tnewUtterance.pitch = state.currentPitch;\n\n\t\t\t// Get the main element for highlighting\n\t\t\tconst mainElement = document.querySelector( 'main' );\n\t\t\tconst docView = mainElement?.ownerDocument.defaultView;\n\t\t\tconst selection = docView ? docView.getSelection() : null;\n\n\t\t\tnewUtterance.onboundary = function ( event ) {\n\t\t\t\tif ( ! mainElement ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Remove previous highlights by unwrapping\n\t\t\t\tconst highlighted = mainElement.querySelectorAll(\n\t\t\t\t\t'.mosne-tts-highlighted-word'\n\t\t\t\t);\n\n\t\t\t\thighlighted.forEach( ( wrapper ) => {\n\t\t\t\t\t// Replace the wrapper with its text content\n\t\t\t\t\tconst parent = wrapper.parentNode;\n\t\t\t\t\tparent.replaceChild(\n\t\t\t\t\t\tdocument.createTextNode( wrapper.textContent ),\n\t\t\t\t\t\twrapper\n\t\t\t\t\t);\n\t\t\t\t} );\n\n\t\t\t\t// Safety check for valid boundary event\n\t\t\t\tif (\n\t\t\t\t\t! event.charIndex ||\n\t\t\t\t\t! event.charLength ||\n\t\t\t\t\tevent.charIndex + event.charLength > content.length\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// If we're reading selected text, we need to handle highlighting differently\n\t\t\t\t\tconst blockWrapper = document.querySelector(\n\t\t\t\t\t\t'[data-wp-interactive=\"mosne-text-to-speech-block\"]'\n\t\t\t\t\t);\n\n\t\t\t\t\tconst highlightBackground =\n\t\t\t\t\t\tblockWrapper?.dataset.highlightBackground || '#ffeb3b';\n\t\t\t\t\tconst highlightColor =\n\t\t\t\t\t\tblockWrapper?.dataset.highlightColor || '#000000';\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tstate.selectedTextRange &&\n\t\t\t\t\t\tstate.selectedTextRange.hasSelection\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Create a new highlight for the selection\n\t\t\t\t\t\tif ( selection && selection.rangeCount > 0 ) {\n\t\t\t\t\t\t\t// wrap the selection in a span with the class 'mosne-tts-highlighted-word'\n\t\t\t\t\t\t\tconst selectionRange = selection.getRangeAt( 0 );\n\t\t\t\t\t\t\tconst selectionWrapper =\n\t\t\t\t\t\t\t\tdocument.createElement( 'span' );\n\t\t\t\t\t\t\tselectionWrapper.className =\n\t\t\t\t\t\t\t\t'mosne-tts-highlighted-word';\n\t\t\t\t\t\t\tselectionWrapper.style.setProperty(\n\t\t\t\t\t\t\t\t'--mosne-tts-highlight-bg',\n\t\t\t\t\t\t\t\thighlightBackground\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tselectionWrapper.style.setProperty(\n\t\t\t\t\t\t\t\t'--mosne-tts-highlight-color',\n\t\t\t\t\t\t\t\thighlightColor\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tselectionRange.surroundContents( selectionWrapper );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Original highlighting logic for main content\n\n\t\t\t\t\t\t// Get excluded classes from data attribute or use default\n\t\t\t\t\t\tconst excludeClassesStr =\n\t\t\t\t\t\t\tblockWrapper?.dataset.excludeClass || 'skip-speech';\n\t\t\t\t\t\t// Split by spaces to get array of class names to exclude\n\t\t\t\t\t\tconst excludeClasses = excludeClassesStr.split( /\\s+/ );\n\n\t\t\t\t\t\tconst walker = document.createTreeWalker(\n\t\t\t\t\t\t\tmainElement,\n\t\t\t\t\t\t\tNodeFilter.SHOW_TEXT,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tacceptNode( node ) {\n\t\t\t\t\t\t\t\t\tlet current = node.parentElement;\n\t\t\t\t\t\t\t\t\twhile ( current ) {\n\t\t\t\t\t\t\t\t\t\tif ( current.classList ) {\n\t\t\t\t\t\t\t\t\t\t\t// Check if element has any of the excluded classes\n\t\t\t\t\t\t\t\t\t\t\tfor ( const excludeClass of excludeClasses ) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\texcludeClass &&\n\t\t\t\t\t\t\t\t\t\t\t\t\tcurrent.classList.contains(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\texcludeClass\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcurrent = current.parentElement;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfalse\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tlet charCount = 0;\n\t\t\t\t\t\tlet node;\n\n\t\t\t\t\t\t// Find the text node that contains the current position\n\t\t\t\t\t\twhile ( ( node = walker.nextNode() ) ) {\n\t\t\t\t\t\t\tconst nodeLength = node.length;\n\t\t\t\t\t\t\tif ( charCount + nodeLength > event.charIndex ) {\n\t\t\t\t\t\t\t\t// Found the node containing the current position\n\n\t\t\t\t\t\t\t\t// Create wrapper span\n\t\t\t\t\t\t\t\tconst wrapper =\n\t\t\t\t\t\t\t\t\tdocument.createElement( 'span' );\n\t\t\t\t\t\t\t\twrapper.className =\n\t\t\t\t\t\t\t\t\t'mosne-tts-highlighted-word';\n\t\t\t\t\t\t\t\twrapper.style.setProperty(\n\t\t\t\t\t\t\t\t\t'--mosne-tts-highlight-bg',\n\t\t\t\t\t\t\t\t\thighlightBackground\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\twrapper.style.setProperty(\n\t\t\t\t\t\t\t\t\t'--mosne-tts-highlight-color',\n\t\t\t\t\t\t\t\t\thighlightColor\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t// Wrap the text content\n\t\t\t\t\t\t\t\twrapper.textContent = node.textContent;\n\t\t\t\t\t\t\t\tnode.parentNode.replaceChild( wrapper, node );\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcharCount += nodeLength;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// silent error\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Update the onend event handler to move to next chunk or finish\n\t\t\tnewUtterance.onend = function () {\n\t\t\t\tif ( mainElement ) {\n\t\t\t\t\tconst highlighted = mainElement.querySelectorAll(\n\t\t\t\t\t\t'.mosne-tts-highlighted-word'\n\t\t\t\t\t);\n\t\t\t\t\thighlighted.forEach( ( wrapper ) => {\n\t\t\t\t\t\tconst parent = wrapper.parentNode;\n\t\t\t\t\t\tparent.replaceChild(\n\t\t\t\t\t\t\tdocument.createTextNode( wrapper.textContent ),\n\t\t\t\t\t\t\twrapper\n\t\t\t\t\t\t);\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Check if there are more chunks to process\n\t\t\t\tif (\n\t\t\t\t\tstate.currentChunk < state.textChunks.length - 1 &&\n\t\t\t\t\tstate.isPlaying\n\t\t\t\t) {\n\t\t\t\t\t// Move to next chunk\n\t\t\t\t\tstate.currentChunk++;\n\n\t\t\t\t\t// Create and play next utterance\n\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\tactions.createUtterance();\n\t\t\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t\t\t}, 250 ); // Brief pause between chunks\n\t\t\t\t} else {\n\t\t\t\t\t// Reset chunks and finish\n\t\t\t\t\tstate.currentChunk = 0;\n\t\t\t\t\tstate.textChunks = [];\n\t\t\t\t\tstate.isPlaying = false;\n\n\t\t\t\t\t// Clear selected text range\n\t\t\t\t\tstate.selectedTextRange = {\n\t\t\t\t\t\thasSelection: false,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif ( state.currentVoice ) {\n\t\t\t\tconst voice = state.voices.find(\n\t\t\t\t\t( v ) => v.voiceURI === state.currentVoice.voiceURI\n\t\t\t\t);\n\t\t\t\tnewUtterance.voice = voice;\n\t\t\t}\n\t\t\tstate.utterance = newUtterance;\n\t\t},\n\t\tasync updateUtterance() {\n\t\t\tconst utterance = state.utterance;\n\t\t\tif ( utterance ) {\n\t\t\t\twindow.speechSynthesis.cancel();\n\t\t\t\tactions.clearHighlights();\n\t\t\t\tstate.isPlaying = false;\n\n\t\t\t\tawait actions.checkSynthesisReady();\n\t\t\t\tactions.createUtterance();\n\t\t\t}\n\t\t},\n\t\tclearHighlights() {\n\t\t\tconst mainElement = document.querySelector( 'main' );\n\t\t\tif ( mainElement ) {\n\t\t\t\tconst highlighted = mainElement.querySelectorAll(\n\t\t\t\t\t'.mosne-tts-highlighted-word'\n\t\t\t\t);\n\t\t\t\thighlighted.forEach( ( el ) => {\n\t\t\t\t\tconst parent = el.parentNode;\n\t\t\t\t\tparent.replaceChild(\n\t\t\t\t\t\tdocument.createTextNode( el.textContent ),\n\t\t\t\t\t\tel\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\t\tPlay() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = true;\n\t\t\tstate.isPlaying = true;\n\n\t\t\t// If this is the first play or starting over, get content and create chunks\n\t\t\tif ( state.textChunks.length === 0 || state.currentChunk === 0 ) {\n\t\t\t\tactions.getContent();\n\t\t\t\tactions.createUtterance();\n\t\t\t}\n\n\t\t\t// If paused, just resume\n\t\t\tif ( window.speechSynthesis.paused ) {\n\t\t\t\twindow.speechSynthesis.resume();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Chrome fix: force reset synthesis if it's in a bad state\n\t\t\tif ( window.speechSynthesis.speaking ) {\n\t\t\t\twindow.speechSynthesis.cancel();\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tif ( state.utterance ) {\n\t\t\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t\t\t}\n\t\t\t\t}, 50 );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Start new speech if not already speaking\n\t\t\tif ( state.utterance ) {\n\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t}\n\t\t},\n\t\tPause() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\tstate.isPlaying = false;\n\n\t\t\t// Only pause if currently speaking and the browser supports pausing\n\t\t\tif (\n\t\t\t\twindow.speechSynthesis.speaking &&\n\t\t\t\t! window.speechSynthesis.paused\n\t\t\t) {\n\t\t\t\twindow.speechSynthesis.pause();\n\t\t\t}\n\t\t},\n\t\tRestart() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\tstate.isPlaying = false;\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tstate.currentChunk = 0;\n\t\t\tstate.textChunks = [];\n\n\t\t\tactions.clearHighlights();\n\t\t},\n\t\tchangeVoice( e ) {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\n\t\t\t// Cancel any ongoing speech\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tconst voice = state.voices.find(\n\t\t\t\t( v ) => v.voiceURI === e.target.value\n\t\t\t);\n\n\t\t\tif ( voice ) {\n\t\t\t\tstate.currentVoice = voice;\n\t\t\t\twindow.localStorage.setItem(\n\t\t\t\t\t'mosne-tts-lang-' + document.documentElement.lang,\n\t\t\t\t\tvoice.voiceURI\n\t\t\t\t);\n\n\t\t\t\t// Small delay to ensure speech synthesis is ready\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tactions.updateUtterance();\n\t\t\t\t}, 50 );\n\t\t\t}\n\t\t},\n\t\tasync changeSpeed( e ) {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tstate.currentSpeed = e.target.value;\n\t\t\twindow.localStorage.setItem(\n\t\t\t\t'mosne-tts-speed-' + document.documentElement.lang,\n\t\t\t\te.target.value\n\t\t\t);\n\n\t\t\tawait actions.checkSynthesisReady();\n\t\t\tactions.createUtterance();\n\n\t\t\tif ( context.isPlaying ) {\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t\t}, 50 );\n\t\t\t}\n\t\t},\n\t\tasync changePitch( e ) {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isPlaying = false;\n\t\t\twindow.speechSynthesis.cancel();\n\n\t\t\tstate.currentPitch = e.target.value;\n\t\t\twindow.localStorage.setItem(\n\t\t\t\t'mosne-tts-pitch-' + document.documentElement.lang,\n\t\t\t\te.target.value\n\t\t\t);\n\n\t\t\tawait actions.checkSynthesisReady();\n\t\t\tactions.createUtterance();\n\n\t\t\tif ( context.isPlaying ) {\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\twindow.speechSynthesis.speak( state.utterance );\n\t\t\t\t}, 50 );\n\t\t\t}\n\t\t},\n\t\ttoggleSettings() {\n\t\t\tconst context = getContext();\n\t\t\tcontext.showSettings = ! context.showSettings;\n\t\t},\n\t\tgetContent() {\n\t\t\t// Check if there is highlighted text\n\t\t\tconst mainElement = document.querySelector( 'main' );\n\t\t\tconst docView = mainElement?.ownerDocument.defaultView;\n\t\t\tconst selection = docView ? docView.getSelection() : null;\n\t\t\tlet content = '';\n\n\t\t\tif ( selection && selection.toString().trim().length > 0 ) {\n\t\t\t\t// Get selected text\n\t\t\t\tcontent = selection.toString();\n\t\t\t\tstate.selectedTextRange = {\n\t\t\t\t\ttext: content,\n\t\t\t\t\thasSelection: true,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\t// Get content from main element\n\t\t\t\tlet cloneMain = mainElement?.cloneNode( true );\n\t\t\t\tif ( cloneMain ) {\n\t\t\t\t\t// Use the same exclude classes logic for consistency\n\t\t\t\t\tconst blockWrapper = document.querySelector(\n\t\t\t\t\t\t'[data-wp-interactive=\"mosne-text-to-speech-block\"]'\n\t\t\t\t\t);\n\t\t\t\t\tconst excludeClassesStr =\n\t\t\t\t\t\tblockWrapper?.dataset.excludeClass || 'skip-speech';\n\t\t\t\t\tconst excludeClasses = excludeClassesStr.split( /\\s+/ );\n\n\t\t\t\t\t// Remove all elements with excluded classes\n\t\t\t\t\texcludeClasses.forEach( ( excludeClass ) => {\n\t\t\t\t\t\tif ( excludeClass ) {\n\t\t\t\t\t\t\tconst skip = cloneMain.querySelectorAll(\n\t\t\t\t\t\t\t\t`.${ excludeClass }`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tskip.forEach( ( el ) => {\n\t\t\t\t\t\t\t\tel.remove();\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\tcontent = cloneMain.textContent;\n\t\t\t\t\tcloneMain = null;\n\t\t\t\t}\n\n\t\t\t\tstate.selectedTextRange = {\n\t\t\t\t\thasSelection: false,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Process content into chunks of approximately 200 words\n\t\t\tstate.textChunks = actions.chunkText( content, 200 );\n\t\t\tstate.currentChunk = 0;\n\n\t\t\t// Return the first chunk to start with\n\t\t\treturn state.textChunks.length > 0 ? state.textChunks[ 0 ] : '';\n\t\t},\n\t\t// New method to chunk text into approximately word-sized pieces\n\t\tchunkText( text, wordsPerChunk ) {\n\t\t\tif ( ! text || text.trim() === '' ) {\n\t\t\t\treturn [ '' ];\n\t\t\t}\n\n\t\t\t// Split the text into words\n\t\t\tconst words = text.trim().split( /\\s+/ );\n\t\t\tconst chunks = [];\n\n\t\t\t// Create chunks of approximately wordsPerChunk words\n\t\t\tfor ( let i = 0; i < words.length; i += wordsPerChunk ) {\n\t\t\t\tconst chunk = words.slice( i, i + wordsPerChunk ).join( ' ' );\n\t\t\t\tchunks.push( chunk );\n\t\t\t}\n\n\t\t\treturn chunks;\n\t\t},\n\t},\n\tcallbacks: {\n\t\tinit() {\n\t\t\t// Initialize voices when available\n\t\t\tif ( window.speechSynthesis ) {\n\t\t\t\twindow.speechSynthesis.cancel();\n\t\t\t\tactions.loadVoices();\n\t\t\t\tif ( window.speechSynthesis.onvoiceschanged !== undefined ) {\n\t\t\t\t\twindow.speechSynthesis.onvoiceschanged = actions.loadVoices;\n\t\t\t\t}\n\n\t\t\t\t// Add beforeunload event listener\n\t\t\t\twindow.addEventListener( 'beforeunload', () => {\n\t\t\t\t\twindow.speechSynthesis.cancel();\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\t\tisSelected() {\n\t\t\tconst context = getContext();\n\t\t\treturn context.voice.voiceURI === state.currentVoice.voiceURI;\n\t\t},\n\t},\n} );\n"],"names":["store","getContext","state","actions","isPlaying","currentVoice","preferredVoice","window","localStorage","getItem","document","documentElement","lang","utterance","voices","currentSpeed","currentPitch","selectedTextRange","hasSelection","currentChunk","textChunks","isProcessingChunks","checkSynthesisReady","Promise","resolve","check","speechSynthesis","speaking","pending","setTimeout","loadVoices","availableVoices","getVoices","length","currentLocale","localVoices","filter","voice","startsWith","find","v","voiceURI","createUtterance","content","getContent","newUtterance","SpeechSynthesisUtterance","rate","pitch","mainElement","querySelector","docView","ownerDocument","defaultView","selection","getSelection","onboundary","event","highlighted","querySelectorAll","forEach","wrapper","parent","parentNode","replaceChild","createTextNode","textContent","charIndex","charLength","blockWrapper","highlightBackground","dataset","highlightColor","rangeCount","selectionRange","getRangeAt","selectionWrapper","createElement","className","style","setProperty","surroundContents","excludeClassesStr","excludeClass","excludeClasses","split","walker","createTreeWalker","NodeFilter","SHOW_TEXT","acceptNode","node","current","parentElement","classList","contains","FILTER_REJECT","FILTER_ACCEPT","charCount","nextNode","nodeLength","e","onend","speak","updateUtterance","cancel","clearHighlights","el","Play","context","paused","resume","Pause","pause","Restart","changeVoice","target","value","setItem","changeSpeed","changePitch","toggleSettings","showSettings","toString","trim","text","cloneMain","cloneNode","skip","remove","chunkText","wordsPerChunk","words","chunks","i","chunk","slice","join","push","callbacks","init","onvoiceschanged","undefined","addEventListener","isSelected"],"sourceRoot":""}